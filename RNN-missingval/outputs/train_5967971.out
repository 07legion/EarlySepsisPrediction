Split Speed finished. Start to generate Mask, Delta, Last_observed_X ...
Generate Mask, Delta, Last_observed_X finished. Start to shuffle and split dataset ...
Finished
Model Structure:  GRUD (
  (fc): Linear (38 -> 1)
  (sigmoid): Sigmoid ()
  (zl): Linear (114 -> 38)
  (rl): Linear (114 -> 38)
  (hl): Linear (114 -> 38)
  (gamma_x_l): FilterLinear(in_features=38, out_features=38, bias=True)
  (gamma_h_l): Linear (38 -> 38)
)
Start Training ... 
Output type dermined by the model
Epoch: 0, train_loss: [ 0.07552284], valid_loss: [ 0.07505596], time: [ 183.13], best model: 1
Epoch: 1, train_loss: [ 0.06143714], valid_loss: [ 0.06160348], time: [ 129.48], best model: 1
Epoch: 2, train_loss: [ 0.06040779], valid_loss: [ 0.06114114], time: [ 129.42], best model: 1
Epoch: 3, train_loss: [ 0.0587432], valid_loss: [ 0.06113125], time: [ 125.12], best model: 0
Epoch: 4, train_loss: [ 0.05762335], valid_loss: [ 0.05863064], time: [ 123.66], best model: 1
Epoch: 5, train_loss: [ 0.05714209], valid_loss: [ 0.05864948], time: [ 124.74], best model: 0
Epoch: 6, train_loss: [ 0.05684006], valid_loss: [ 0.05879382], time: [ 125.9], best model: 0
Epoch: 7, train_loss: [ 0.0566092], valid_loss: [ 0.05804314], time: [ 127.88], best model: 1
Epoch: 8, train_loss: [ 0.05631838], valid_loss: [ 0.05741111], time: [ 127.59], best model: 1
Epoch: 9, train_loss: [ 0.05606792], valid_loss: [ 0.05808711], time: [ 126.68], best model: 0
Epoch: 10, train_loss: [ 0.05582716], valid_loss: [ 0.05780278], time: [ 124.24], best model: 0
Epoch: 11, train_loss: [ 0.0556836], valid_loss: [ 0.05718406], time: [ 126.57], best model: 1
Epoch: 12, train_loss: [ 0.05552413], valid_loss: [ 0.05780152], time: [ 132.7], best model: 0
Epoch: 13, train_loss: [ 0.05540993], valid_loss: [ 0.05696546], time: [ 133.34], best model: 1
Epoch: 14, train_loss: [ 0.05514808], valid_loss: [ 0.05680624], time: [ 133.68], best model: 1
Epoch: 15, train_loss: [ 0.0550499], valid_loss: [ 0.05713068], time: [ 133.32], best model: 0
Epoch: 16, train_loss: [ 0.05493382], valid_loss: [ 0.0564753], time: [ 135.41], best model: 1
Epoch: 17, train_loss: [ 0.05452905], valid_loss: [ 0.05727726], time: [ 136.25], best model: 0
Epoch: 18, train_loss: [ 0.05460085], valid_loss: [ 0.05702114], time: [ 135.58], best model: 0
Epoch: 19, train_loss: [ 0.05437081], valid_loss: [ 0.05641392], time: [ 130.16], best model: 1
Epoch: 20, train_loss: [ 0.05420899], valid_loss: [ 0.05667486], time: [ 129.71], best model: 0
Epoch: 21, train_loss: [ 0.05418195], valid_loss: [ 0.05616932], time: [ 131.11], best model: 1
Epoch: 22, train_loss: [ 0.0539634], valid_loss: [ 0.0561021], time: [ 128.21], best model: 1
Epoch: 23, train_loss: [ 0.05376003], valid_loss: [ 0.0561742], time: [ 129.05], best model: 0
Epoch: 24, train_loss: [ 0.05365157], valid_loss: [ 0.05634774], time: [ 134.34], best model: 0
Epoch: 25, train_loss: [ 0.0533479], valid_loss: [ 0.05597054], time: [ 127.77], best model: 1
Epoch: 26, train_loss: [ 0.05321297], valid_loss: [ 0.05567652], time: [ 133.73], best model: 1
Epoch: 27, train_loss: [ 0.0530143], valid_loss: [ 0.05554194], time: [ 129.63], best model: 1
Epoch: 28, train_loss: [ 0.05278423], valid_loss: [ 0.05516473], time: [ 132.96], best model: 1
Epoch: 29, train_loss: [ 0.05251654], valid_loss: [ 0.05522278], time: [ 134.64], best model: 0
Epoch: 30, train_loss: [ 0.05226518], valid_loss: [ 0.05612948], time: [ 131.45], best model: 0
Epoch: 31, train_loss: [ 0.05206186], valid_loss: [ 0.05578586], time: [ 131.19], best model: 0
Epoch: 32, train_loss: [ 0.05181304], valid_loss: [ 0.05507002], time: [ 136.06], best model: 1
Epoch: 33, train_loss: [ 0.0515552], valid_loss: [ 0.05446954], time: [ 131.27], best model: 1
Epoch: 34, train_loss: [ 0.05125592], valid_loss: [ 0.05468008], time: [ 131.39], best model: 0
Epoch: 35, train_loss: [ 0.05104072], valid_loss: [ 0.05304976], time: [ 131.92], best model: 1
Epoch: 36, train_loss: [ 0.05074712], valid_loss: [ 0.05364512], time: [ 131.84], best model: 0
Epoch: 37, train_loss: [ 0.05045976], valid_loss: [ 0.05389474], time: [ 130.71], best model: 0
Epoch: 38, train_loss: [ 0.05005284], valid_loss: [ 0.0529892], time: [ 129.62], best model: 1
Epoch: 39, train_loss: [ 0.04985896], valid_loss: [ 0.05416772], time: [ 127.75], best model: 0
Epoch: 40, train_loss: [ 0.04948941], valid_loss: [ 0.05305898], time: [ 131.78], best model: 0
Epoch: 41, train_loss: [ 0.04919768], valid_loss: [ 0.05288206], time: [ 137.06], best model: 1
Epoch: 42, train_loss: [ 0.04899028], valid_loss: [ 0.05244808], time: [ 151.03], best model: 1
Epoch: 43, train_loss: [ 0.04851872], valid_loss: [ 0.05352929], time: [ 151.95], best model: 0
Epoch: 44, train_loss: [ 0.04839322], valid_loss: [ 0.05288609], time: [ 153.4], best model: 0
Epoch: 45, train_loss: [ 0.04812778], valid_loss: [ 0.0519711], time: [ 151.97], best model: 1
Epoch: 46, train_loss: [ 0.04783344], valid_loss: [ 0.05319658], time: [ 151.32], best model: 0
Epoch: 47, train_loss: [ 0.04742816], valid_loss: [ 0.05200254], time: [ 151.96], best model: 0
Epoch: 48, train_loss: [ 0.04738282], valid_loss: [ 0.05214491], time: [ 153.11], best model: 0
Epoch: 49, train_loss: [ 0.04696156], valid_loss: [ 0.05220476], time: [ 152.5], best model: 0
Epoch: 50, train_loss: [ 0.04670384], valid_loss: [ 0.05178946], time: [ 152.91], best model: 1
Epoch: 51, train_loss: [ 0.04655488], valid_loss: [ 0.05075521], time: [ 152.86], best model: 1
Epoch: 52, train_loss: [ 0.04612259], valid_loss: [ 0.05094591], time: [ 153.05], best model: 0
Epoch: 53, train_loss: [ 0.04611417], valid_loss: [ 0.05010461], time: [ 152.79], best model: 1
Epoch: 54, train_loss: [ 0.04553523], valid_loss: [ 0.05108128], time: [ 153.53], best model: 0
Epoch: 55, train_loss: [ 0.04542282], valid_loss: [ 0.0512344], time: [ 154.57], best model: 0
Epoch: 56, train_loss: [ 0.04502928], valid_loss: [ 0.05123972], time: [ 155.44], best model: 0
Epoch: 57, train_loss: [ 0.04476328], valid_loss: [ 0.05064999], time: [ 154.68], best model: 0
Epoch: 58, train_loss: [ 0.04447144], valid_loss: [ 0.05077707], time: [ 153.07], best model: 0
Epoch: 59, train_loss: [ 0.0441632], valid_loss: [ 0.04978862], time: [ 155.25], best model: 1
Epoch: 60, train_loss: [ 0.04377848], valid_loss: [ 0.04896278], time: [ 155.4], best model: 1
Epoch: 61, train_loss: [ 0.04323432], valid_loss: [ 0.0496419], time: [ 152.89], best model: 0
Epoch: 62, train_loss: [ 0.0429506], valid_loss: [ 0.05014336], time: [ 152.4], best model: 0
Epoch: 63, train_loss: [ 0.04282638], valid_loss: [ 0.05028783], time: [ 152.76], best model: 0
Epoch: 64, train_loss: [ 0.04239725], valid_loss: [ 0.04872472], time: [ 153.14], best model: 1
Epoch: 65, train_loss: [ 0.04212899], valid_loss: [ 0.04885404], time: [ 153.53], best model: 0
Epoch: 66, train_loss: [ 0.04157048], valid_loss: [ 0.04822714], time: [ 153.52], best model: 1
Epoch: 67, train_loss: [ 0.0412181], valid_loss: [ 0.05006663], time: [ 154.84], best model: 0
Epoch: 68, train_loss: [ 0.04110832], valid_loss: [ 0.04913258], time: [ 156.67], best model: 0
Epoch: 69, train_loss: [ 0.04050102], valid_loss: [ 0.0483432], time: [ 155.43], best model: 0
Epoch: 70, train_loss: [ 0.04028928], valid_loss: [ 0.04832517], time: [ 153.63], best model: 0
Epoch: 71, train_loss: [ 0.03989476], valid_loss: [ 0.04824913], time: [ 155.43], best model: 0
Epoch: 72, train_loss: [ 0.0396089], valid_loss: [ 0.04746519], time: [ 158.54], best model: 1
Epoch: 73, train_loss: [ 0.03922898], valid_loss: [ 0.04692387], time: [ 158.59], best model: 1
Epoch: 74, train_loss: [ 0.03894998], valid_loss: [ 0.04848972], time: [ 157.69], best model: 0
Epoch: 75, train_loss: [ 0.03868642], valid_loss: [ 0.04731652], time: [ 165.52], best model: 0
Epoch: 76, train_loss: [ 0.03817255], valid_loss: [ 0.04808042], time: [ 165.9], best model: 0
Epoch: 77, train_loss: [ 0.03817792], valid_loss: [ 0.04662178], time: [ 162.24], best model: 1
Epoch: 78, train_loss: [ 0.03766588], valid_loss: [ 0.045936], time: [ 161.83], best model: 1
Epoch: 79, train_loss: [ 0.03752184], valid_loss: [ 0.04699911], time: [ 158.57], best model: 0
Epoch: 80, train_loss: [ 0.03720723], valid_loss: [ 0.04636099], time: [ 155.67], best model: 0
Epoch: 81, train_loss: [ 0.03663992], valid_loss: [ 0.04741886], time: [ 155.54], best model: 0
Epoch: 82, train_loss: [ 0.03665309], valid_loss: [ 0.04590284], time: [ 155.28], best model: 1
Epoch: 83, train_loss: [ 0.03629956], valid_loss: [ 0.04621306], time: [ 154.41], best model: 0
Epoch: 84, train_loss: [ 0.0358874], valid_loss: [ 0.04610484], time: [ 154.48], best model: 0
Epoch: 85, train_loss: [ 0.0356612], valid_loss: [ 0.04582488], time: [ 154.], best model: 1
Epoch: 86, train_loss: [ 0.03540642], valid_loss: [ 0.04613686], time: [ 153.59], best model: 0
Epoch: 87, train_loss: [ 0.03502462], valid_loss: [ 0.04637246], time: [ 152.76], best model: 0
Epoch: 88, train_loss: [ 0.03487292], valid_loss: [ 0.04612896], time: [ 153.25], best model: 0
Epoch: 89, train_loss: [ 0.0346008], valid_loss: [ 0.04496087], time: [ 153.65], best model: 1
Epoch: 90, train_loss: [ 0.03439966], valid_loss: [ 0.04463947], time: [ 154.51], best model: 1
Epoch: 91, train_loss: [ 0.03411859], valid_loss: [ 0.0445832], time: [ 155.3], best model: 1
Epoch: 92, train_loss: [ 0.03379836], valid_loss: [ 0.0457846], time: [ 155.96], best model: 0
Epoch: 93, train_loss: [ 0.03360065], valid_loss: [ 0.04461409], time: [ 155.28], best model: 0
Epoch: 94, train_loss: [ 0.03343882], valid_loss: [ 0.04547112], time: [ 154.64], best model: 0
Epoch: 95, train_loss: [ 0.03310988], valid_loss: [ 0.04493938], time: [ 153.43], best model: 0
Epoch: 96, train_loss: [ 0.03293677], valid_loss: [ 0.04501868], time: [ 154.28], best model: 0
Epoch: 97, train_loss: [ 0.03263223], valid_loss: [ 0.04485818], time: [ 153.21], best model: 0
Epoch: 98, train_loss: [ 0.03247219], valid_loss: [ 0.04436356], time: [ 153.53], best model: 1
Epoch: 99, train_loss: [ 0.03194682], valid_loss: [ 0.04462254], time: [ 153.19], best model: 0
Epoch: 100, train_loss: [ 0.03184325], valid_loss: [ 0.04513169], time: [ 153.18], best model: 0
Epoch: 101, train_loss: [ 0.03161686], valid_loss: [ 0.04449138], time: [ 153.35], best model: 0
Epoch: 102, train_loss: [ 0.03138517], valid_loss: [ 0.0434922], time: [ 154.04], best model: 1
Epoch: 103, train_loss: [ 0.03133888], valid_loss: [ 0.04441038], time: [ 154.69], best model: 0
Epoch: 104, train_loss: [ 0.03099895], valid_loss: [ 0.04324721], time: [ 155.49], best model: 1
Epoch: 105, train_loss: [ 0.03069436], valid_loss: [ 0.04417436], time: [ 155.2], best model: 0
Epoch: 106, train_loss: [ 0.03048785], valid_loss: [ 0.0428699], time: [ 152.19], best model: 1
Epoch: 107, train_loss: [ 0.03033402], valid_loss: [ 0.04387058], time: [ 149.36], best model: 0
Epoch: 108, train_loss: [ 0.03022226], valid_loss: [ 0.04308671], time: [ 147.02], best model: 0
Epoch: 109, train_loss: [ 0.02996475], valid_loss: [ 0.04361606], time: [ 146.33], best model: 0
Epoch: 110, train_loss: [ 0.02977565], valid_loss: [ 0.04330878], time: [ 142.19], best model: 0
Epoch: 111, train_loss: [ 0.02969026], valid_loss: [ 0.04251114], time: [ 139.82], best model: 1
Epoch: 112, train_loss: [ 0.02949936], valid_loss: [ 0.04340368], time: [ 135.69], best model: 0
Epoch: 113, train_loss: [ 0.02912327], valid_loss: [ 0.04200753], time: [ 135.63], best model: 1
Epoch: 114, train_loss: [ 0.02870669], valid_loss: [ 0.0431296], time: [ 135.88], best model: 0
Epoch: 115, train_loss: [ 0.02862326], valid_loss: [ 0.04234926], time: [ 135.51], best model: 0
Epoch: 116, train_loss: [ 0.02866926], valid_loss: [ 0.04246453], time: [ 135.56], best model: 0
Epoch: 117, train_loss: [ 0.02825967], valid_loss: [ 0.04178747], time: [ 135.25], best model: 1
Epoch: 118, train_loss: [ 0.02792446], valid_loss: [ 0.04259042], time: [ 134.91], best model: 0
Epoch: 119, train_loss: [ 0.02758151], valid_loss: [ 0.04227908], time: [ 135.57], best model: 0
Epoch: 120, train_loss: [ 0.02745996], valid_loss: [ 0.04082758], time: [ 135.43], best model: 1
Epoch: 121, train_loss: [ 0.02762431], valid_loss: [ 0.04241739], time: [ 135.63], best model: 0
Epoch: 122, train_loss: [ 0.02713105], valid_loss: [ 0.04093045], time: [ 134.62], best model: 0
Epoch: 123, train_loss: [ 0.02709284], valid_loss: [ 0.04079782], time: [ 134.14], best model: 1
Epoch: 124, train_loss: [ 0.02661053], valid_loss: [ 0.04184337], time: [ 134.16], best model: 0
Epoch: 125, train_loss: [ 0.02661009], valid_loss: [ 0.04162203], time: [ 135.45], best model: 0
Epoch: 126, train_loss: [ 0.02623509], valid_loss: [ 0.04113678], time: [ 135.58], best model: 0
Epoch: 127, train_loss: [ 0.02596206], valid_loss: [ 0.04129298], time: [ 135.42], best model: 0
Epoch: 128, train_loss: [ 0.02568258], valid_loss: [ 0.04147904], time: [ 135.68], best model: 0
Epoch: 129, train_loss: [ 0.02564008], valid_loss: [ 0.04064358], time: [ 135.06], best model: 1
Epoch: 130, train_loss: [ 0.02532618], valid_loss: [ 0.0397481], time: [ 135.33], best model: 1
Epoch: 131, train_loss: [ 0.02539704], valid_loss: [ 0.0393318], time: [ 135.53], best model: 1
Epoch: 132, train_loss: [ 0.0248192], valid_loss: [ 0.04000188], time: [ 136.05], best model: 0
Epoch: 133, train_loss: [ 0.02470158], valid_loss: [ 0.04079154], time: [ 135.79], best model: 0
Epoch: 134, train_loss: [ 0.02458937], valid_loss: [ 0.04071163], time: [ 135.67], best model: 0
Epoch: 135, train_loss: [ 0.02457702], valid_loss: [ 0.03974974], time: [ 135.7], best model: 0
Epoch: 136, train_loss: [ 0.02435362], valid_loss: [ 0.03916504], time: [ 134.99], best model: 1
Epoch: 137, train_loss: [ 0.02386008], valid_loss: [ 0.0395726], time: [ 135.76], best model: 0
Epoch: 138, train_loss: [ 0.02409402], valid_loss: [ 0.03900648], time: [ 134.5], best model: 1
Epoch: 139, train_loss: [ 0.02378278], valid_loss: [ 0.03907781], time: [ 133.15], best model: 0
Epoch: 140, train_loss: [ 0.02333408], valid_loss: [ 0.03872008], time: [ 134.54], best model: 1
Epoch: 141, train_loss: [ 0.02314222], valid_loss: [ 0.03980818], time: [ 135.75], best model: 0
Epoch: 142, train_loss: [ 0.02288148], valid_loss: [ 0.03936466], time: [ 135.65], best model: 0
Epoch: 143, train_loss: [ 0.02311283], valid_loss: [ 0.0391228], time: [ 135.76], best model: 0
Epoch: 144, train_loss: [ 0.02269552], valid_loss: [ 0.0387357], time: [ 135.88], best model: 0
Epoch: 145, train_loss: [ 0.02249381], valid_loss: [ 0.03819093], time: [ 136.1], best model: 1
Epoch: 146, train_loss: [ 0.02215616], valid_loss: [ 0.03961329], time: [ 136.2], best model: 0
Epoch: 147, train_loss: [ 0.0222488], valid_loss: [ 0.03804192], time: [ 135.65], best model: 1
Epoch: 148, train_loss: [ 0.02206344], valid_loss: [ 0.03806622], time: [ 136.], best model: 0
Epoch: 149, train_loss: [ 0.02190012], valid_loss: [ 0.03777246], time: [ 135.94], best model: 1
Epoch: 150, train_loss: [ 0.02188029], valid_loss: [ 0.0386967], time: [ 136.04], best model: 0
Epoch: 151, train_loss: [ 0.02164257], valid_loss: [ 0.03688386], time: [ 135.53], best model: 1
Epoch: 152, train_loss: [ 0.02170199], valid_loss: [ 0.03753185], time: [ 135.61], best model: 0
Epoch: 153, train_loss: [ 0.0214205], valid_loss: [ 0.0380306], time: [ 136.02], best model: 0
Epoch: 154, train_loss: [ 0.02138191], valid_loss: [ 0.03756961], time: [ 136.], best model: 0
Epoch: 155, train_loss: [ 0.02097944], valid_loss: [ 0.03728104], time: [ 131.1], best model: 0
Epoch: 156, train_loss: [ 0.02049932], valid_loss: [ 0.03781298], time: [ 133.73], best model: 0
Epoch: 157, train_loss: [ 0.02072621], valid_loss: [ 0.03833498], time: [ 133.66], best model: 0
Epoch: 158, train_loss: [ 0.02057886], valid_loss: [ 0.03818539], time: [ 135.07], best model: 0
Epoch: 159, train_loss: [ 0.02048595], valid_loss: [ 0.03611498], time: [ 136.03], best model: 1
Epoch: 160, train_loss: [ 0.02018695], valid_loss: [ 0.0382851], time: [ 135.82], best model: 0
Epoch: 161, train_loss: [ 0.02026648], valid_loss: [ 0.03775736], time: [ 136.07], best model: 0
Epoch: 162, train_loss: [ 0.02009243], valid_loss: [ 0.03686738], time: [ 136.21], best model: 0
Epoch: 163, train_loss: [ 0.0198668], valid_loss: [ 0.0373983], time: [ 136.41], best model: 0
Epoch: 164, train_loss: [ 0.01967132], valid_loss: [ 0.03690728], time: [ 136.49], best model: 0
Epoch: 165, train_loss: [ 0.01973712], valid_loss: [ 0.03711348], time: [ 136.58], best model: 0
Epoch: 166, train_loss: [ 0.01958134], valid_loss: [ 0.03663229], time: [ 136.46], best model: 0
Epoch: 167, train_loss: [ 0.01916165], valid_loss: [ 0.03632532], time: [ 135.98], best model: 0
Epoch: 168, train_loss: [ 0.01925336], valid_loss: [ 0.03707136], time: [ 136.42], best model: 0
Early Stopped at Epoch: 169
